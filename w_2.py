import numpy as np
import copy

def suffix_array(text):
	suffixes = []
	indices = []	
	for i in range(len(text)):
		suffixes.append(text[i:])
		indices.append(i)
	indices = [x for _, x in sorted(zip(suffixes,indices), key=lambda pair: pair[0])]
	return indices

def burrows_wheeler_transform(text):
	text = list(text)
	M = []
	#return text
	for i in range(len(text)):
		x = copy.deepcopy(text)
		y = x[-i: ]
		del x[-i: ]
		x = y + x
		M.append(''.join(x))
	M.sort()
	bw = ''
	for string in M:
		bw += string[-1]
	return bw


text = 'GTGCGAGAAGGTGCCCCCGGACACGTTTCATTTCGTCCCCAGTAGTAAGCCGAAGGGCAAGAATCGGCCTCCATTAGCAATTATGCCCTGCTCGCGGTGGCGAAGGTCCCGGTGTTGCGAGGGAAGGTGGACTGGCGTGCGGATTGCGGAGGTGGACCACAATGAAAGTAATGTACGTGTTTATCCTCACTAGGACATGTTTGGTCTACCGGCGATCGGAGTGGTAGGGAACTATTCAGATGCTCGGGGACAAACAGGAACCTGTGTATCGCTGGGTCCTCTATAACCGGTGGCAGGGTCTGACCTACCAATTCTATATCTCAACAGCTACCCGTATCAACAGAAGCAGGCTGTACGCTAATTTTAATGTGAGCGACAGTTACAGCACGTAGGTAGAGTCAGAAACTCGCGTTCGGCAGCTACATAGCCAATACCTCACTTTCTTGACAGCGAACTTGTCTGGCTGGCGAGCCATGGATAGGTGTGGTCGATAATTGGCGCTTCCGTTAATTGGGTAAGACGTTGGAATTTAGAGAACGTAGAGTGGTTAGCCTAGCCAACTTGCTCAACGCGGGGGCATCAGTGCTCCCGGTCCGCCGTTCGGCGCACCCATGCGGGATTTGTCCACTTAAGTAGAACACTGGCCCCCAACGCCAGCGGATTCATGGCTACACCCACTGTACAGCCATCTGTCAACCATGGGAAGGTCCTATCAACCGTATCGCTAATCTCGCGGTCTGAATGCCCGCGTCCCCATAGTAGTTTAGCGATAGACGTTCAAGATCCGACATGATCGTTTAAATATCACCGTGATAGAGTTCACTTGGGGGACAAATACGGCATAGCCATAGTGCGGCGGGTTGATTTGCTGTCAACGCAAC$'
print(burrows_wheeler_transform(text))

'''
text = 'CGGCGTCTCGGGAGATGAGTTAGTGGCAGACTCGAGGGAAAGAGTGCGCGTCATCATGACTACTCTGATTAAGGCAAAAATATTCGAGTACTACAACCAAAAATCCGACAGCTGTGATGCGAGGCATGGGCTTTGTGGTTTGATGATCAGGTGCTCTCACTAGGACGGCATATAAGGAATTTATCTTGTTCCGTACTCATCCAAGCGGCATACGCGCTACAAGGCGAAGTCGCCCGTCCTATTTAATTCCCACTACCTTATGCTTCGTATCCAGCAGCGCGACGTCATAATCTATGTTCGACGCAGGGATCGGTGTGCGTAGCATTAATAAAGACATCTGTGCGGGGAACAGTGACTGTTGACACATCCCGAACAGGTGGCCCCTAGTCACCATTGGCCACGTTCGTTTAAGGAGGTGCCGTACTTGTCCCCATGCGATAAGGATACCGCGTGATCGGGTATCACTGGCACGCGTTACACTAGTGTCACGCTAGTGACCCCTCTGTGGAAGCACGCCTCGAGGGTCCCGTACAAATCAACGAAGAGATCTCATGTCGGGACGAGTAAATAAAGTCTGTCAAGCTTTACTCCGGATGATGACGCATGAGCGAACCAAAGGTAAGTCGGTCCCCACCGACACGAAGTAGTACCAGTGCGAGTTACAAAACTTGTCTCGCTTTGGTTGGTTGGAGGGGTGGATGCCTGACAAGCCGTGCATACACTGTCAGCCGTGGCGTGGTCAAGTCCGTGCTCCAGGCCTAGCCACAGAGCAGGTGCTTCGGTTACCTGGTTCGAACAATAACCGAGCTGACGTGCATTAAAATAGTTATATCGGATCCCAGATGAGCGGTGGGAAGACGGGGAATAGTGTTGCCACCGACCGCCGCGCACCGAAGAGGAATCTTGCGCTGGGAAACATTGTTTCACAGAAGTTTAAGACCAA$'
print(suffix_array(text))
'''